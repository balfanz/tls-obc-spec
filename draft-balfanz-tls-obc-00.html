<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Draft: TLS Origin-Bound Certificates</title>
<meta http-equiv="Expires" content="Wed, 23 Mar 2011 05:36:07 +0000">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TLS Origin-Bound Certificates">
<meta name="keywords" content="TLS, PKI">
<meta name="generator" content="xml2rfc v1.34 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Draft</td><td class="header">D. Balfanz, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Smetters</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Upadhyay</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Barth</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 22, 2011</td></tr>
</table></td></tr></table>
<h1><br />TLS Origin-Bound Certificates</h1>

<h3>Abstract</h3>

<p>This document specifies a Transport Layer Security (TLS)
      extension and associated semantics that allow clients and
      servers to negotiate the use of origin-bound, self-signed
      certificates for TLS client authentication.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#anchor3">2.</a>&nbsp;
Origin-Bound Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Certificate Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.2.</a>&nbsp;
Key Rotation<br />
<a href="#anchor6">3.</a>&nbsp;
Changes to The Handshake Message Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Client Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Server Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
Certificate Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClientCertificateMessage">3.4.</a>&nbsp;
Client Certificate<br />
<a href="#rfc.references1">4.</a>&nbsp;
References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Transport Layer Security (<a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246])
      allows clients to authenticate themselves using Client
      Certificates. In practice, clients tend to ask for user consent
      before using Client Certificates. This is to allay privacy
      concerns about user-identifying information in the Client
      Certificate, and also to let the user choose among possibly many
      certificates that can be used by the client for the TLS
      session.
</p>
<p>The user experience of obtaining this consent, along with
      that of obtaining the certificates in the first place, has
      traditionally presented a hurdle to user adoption. Additionally,
      operational constraints on the server side can make it difficult
      for service providers to switch from a cookie-based
      authentication scheme to certificate-based TLS client
      authentication.
</p>
<p>The TLS Origin-Bound Certificates extension (TLS-OBC) is a
      <a class='info' href='#RFC6066'>TLS extension<span> (</span><span class='info'>Eastlake, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; January&nbsp;2011.</span><span>)</span></a> [RFC6066] that allows clients
      to use certificate-based client authentication without having to
      obtain user consent before using certificates. A client creates
      at most one (self-signed) certificate of any given type per
      <a class='info' href='#WebOrigin'>web origin<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin], and does not include
      user-identifying information into such <em>origin-bound
      certificates</em>, thus making user consent and user-assisted
      certificate selection unnecessary.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described
        in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Origin-Bound Certificates</h3>

<p>An origin-bound certificate is a self-issued certificate that
      the client uses for TLS client authentication for a particular
      <a class='info' href='#WebOrigin'>web origin<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin]. Origin-bound
      certificates MUST be self-signed, i.e., a private key
      corresponding to the certified public key MUST be used to sign
      the certificate.
</p>
<p>Clients SHOULD NOT re-use the same origin-bound certificate
      for more than one web origin.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Certificate Creation</h3>

<p>Clients create origin-bound certificates when asked to
        perform TLS client authentication after negotiating the <tt>ob_cert</tt> extension with a server (see
        <a class='info' href='#ClientCertificateMessage'>Section&nbsp;3.4<span> (</span><span class='info'>Client Certificate</span><span>)</span></a>). When creating an
        origin-bound certificate, it is RECOMMENDED that clients use
        the <a class='info' href='#WebOrigin'>Unicode Serialization<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin] of
        the certificate's web origin as the common name of the
        Distinguished Name of both the certificate's Issuer and
        Subject.
</p>
<p>Origin-bound certificates MUST include the following
        critical extension: TODO[FILL IN DETAILS]
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Key Rotation</h3>

<p>After a client has created an origin-bound certificate for
	a certain web origin, the client SHOULD re-use the certificate
	for a period of time, and then discard it.
</p>
<p>It is RECOMMENDED that clients pick a lifetime for the
	new certificate between one month and one year (perhaps
	depending on an assessment of how well the private key is
	protected on the host platform). The client SHALL use the
	not-before and not-after fields in the new certificate to
	record the lifetime of the new certificate.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Changes to The Handshake Message Contents</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Client Hello</h3>

<p>To indicate support for origin-bound certificates, the
	client includes an extension of type <tt>ob_cert</tt> to the extended Client Hello
	message. The <tt>ob_cert</tt> TLS
	extension is assigned value X from the TLS ExtensionType
	registry, and uses no <tt>extension_data</tt>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Server Hello</h3>

<p>A server that receives a Client Hello message containing
	the <tt>ob_cert</tt> extension MAY choose
	to include the same extension in the extended Server Hello
	message. If it does, the client and server are considered to
	have negotiated origin-bound client certificates for the
	session. Whenever the client is asked to perform client
	authentication during such a session, it MUST use an
	origin-bound certificate.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Certificate Request</h3>

<p>A server MAY choose to send a Certificate Request message
	to the client. If the session uses origin-bound client
	certificates, the server SHOULD use an empty <tt>certificate_authorities</tt> list.
</p>
<p>A client that receives a Certificate Request during a
	session for which origin-bound client certificates were
	negotiated MUST ignore the <tt>certificate_authorities</tt> list.
</p>
<a name="ClientCertificateMessage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Client Certificate</h3>

<p>A client that receives a Certificate Request message MUST
	send a Client Certificate message in response. If client and
	server negotiated origin-bound client certificates, then the
	client SHOULD include a certificate in the Client Certificate
	message.
</p>
<p>If a client includes one or more certificates in the Client
	Certificate message during a session for which origin-bound
	client certificates were negotiated, each included
	certificate MUST 
        </p>
<ul class="text">
<li>be an origin-bound certificate for the web origin of
	    the server, and 
</li>
<li>match a certificate type requested by the server in the
	    Certificate Request message.
</li>
</ul>

<p>If a client doesn't possess a certificate meeting the above
	requirements, it SHOULD self-issue a certificate of a type
	requested by the server in the Certificate Request message and
	include the newly-generated certificate in the Client
	Certificate message. Only if the client is not capable of
	generating a certificate of the requested type SHOULD it
	include an empty <tt>certificate_list</tt>
	in the Client Certificate message.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>4.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6066">[RFC6066]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>,&rdquo; RFC&nbsp;6066, January&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6066.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="WebOrigin">[WebOrigin]</a></td>
<td class="author-text">Barth, A., &ldquo;<a href="http://tools.ietf.org/html/draft-abarth-origin-09">The Web Origin Concept</a>.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dirk Balfanz (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1600 Ampitheatre Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:balfanz@google.com">balfanz@google.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">D K Smetters</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mayank Upadhyay</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adam Barth</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
</table>
</body></html>
