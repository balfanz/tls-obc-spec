<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TLS Origin-Bound Certificates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TLS Origin-Bound Certificates">
<meta name="keywords" content="TLS, PKI">
<meta name="generator" content="xml2rfc v1.34 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">D. Balfanz, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">D. Smetters</td></tr>
<tr><td class="header">Expires: January 19, 2012</td><td class="header">M. Upadhyay</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Barth</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 18, 2011</td></tr>
</table></td></tr></table>
<h1><br />TLS Origin-Bound Certificates<br />draft-balfanz-tls-obc-00</h1>

<h3>Abstract</h3>

<p>This document specifies a Transport Layer Security (TLS)
      extension and associated semantics that allow clients and
      servers to negotiate the use of origin-bound, self-signed
      certificates for TLS client authentication.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 19, 2012.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Extension Dependencies<br />
<a href="#anchor4">2.</a>&nbsp;
Origin-Bound Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
Certificate Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.1.</a>&nbsp;
Origin-Bound Certificate Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.</a>&nbsp;
Certificate and Key Rotation<br />
<a href="#anchor8">3.</a>&nbsp;
Changes to The Handshake Message Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.</a>&nbsp;
Extension Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.</a>&nbsp;
Client Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.3.</a>&nbsp;
Server Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.4.</a>&nbsp;
Certificate Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ClientCertificateMessage">3.5.</a>&nbsp;
Client Certificate<br />
<a href="#anchor13">4.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
Third-Party Tracking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
Server Tracking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.</a>&nbsp;
Cookie Hardening<br />
<a href="#rfc.references1">5.</a>&nbsp;
References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Transport Layer Security (<a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246])
      allows clients to authenticate themselves using Client
      Certificates. In practice, clients tend to ask for user consent
      before using Client Certificates. This is to allay privacy
      concerns about user-identifying information in the Client
      Certificate, and also to let the user choose among possibly many
      certificates that can be used by the client for the TLS
      session.
</p>
<p>The user experience of obtaining this consent, along with
      that of obtaining the certificates in the first place, has
      traditionally presented a hurdle to user adoption. Additionally,
      operational constraints on the server side can make it difficult
      for service providers to switch from a cookie-based
      authentication scheme to certificate-based TLS client
      authentication.
</p>
<p>The TLS Origin-Bound Certificates extension (TLS-OBC) is a
      <a class='info' href='#RFC6066'>TLS extension<span> (</span><span class='info'>Eastlake, D., &ldquo;Transport Layer Security (TLS) Extensions: Extension Definitions,&rdquo; January&nbsp;2011.</span><span>)</span></a> [RFC6066] that allows clients
      to use certificate-based client authentication without having to
      obtain user consent before using certificates. A client creates
      at most one (self-signed) certificate of any given type per
      <a class='info' href='#WebOrigin'>web origin<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin], and does not include
      user-identifying information into such <em>origin-bound
      certificates</em>, thus making user consent and user-assisted
      certificate selection unnecessary.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described
        in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Extension Dependencies</h3>

<p>The client SHOULD use TLS-OBC during a TLS session only if
	it also uses the <a class='info' href='#CertMessageReordering'>TLS-MessageReordering<span> (</span><span class='info'>, &ldquo;TODO: Reference for ClientCertificate message 	  reordering,&rdquo; .</span><span>)</span></a> [CertMessageReordering] extension
	during that TLS session.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Origin-Bound Certificates</h3>

<p>An origin-bound certificate is a self-issued certificate that
      the client uses for TLS client authentication for a particular
      <a class='info' href='#WebOrigin'>web origin<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin]. Origin-bound
      certificates MUST be self-signed, i.e., a private key
      corresponding to the certified public key MUST be used to sign
      the certificate.
</p>
<p>Clients MUST NOT re-use the same origin-bound certificate
      for more than one web origin.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Certificate Creation</h3>

<p>Clients create origin-bound certificates when asked to
        perform TLS client authentication after negotiating the <tt>ob_cert</tt> extension with a server from
	that origin (see <a class='info' href='#ClientCertificateMessage'>Section&nbsp;3.5<span> (</span><span class='info'>Client Certificate</span><span>)</span></a>),
	and they do not already have a valid origin-bound certificate
	for that origin available for use.
</p>
<p>Clients SHOULD NOT re-use the same key pair for more than
        one origin-bound certificate. To do so would violate the
        privacy properties required by origin-bound certificates.
</p>
<p>When creating an origin-bound certificate, it is
        RECOMMENDED that clients use the PrintableString
        representation of "anonymous.invalid" as the common name
        component of the Distinguished Name of both the certificate's
        Issuer and Subject, with no other name components present.
</p>
<p>It is RECOMMENDED that clients pick a lifetime for the
	new certificate between one month and one year (perhaps
	depending on an assessment of how well the private key is
	protected on the host platform). The client SHALL use the
	notBefore and notAfter fields in the new certificate to
	record the lifetime of the new certificate.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Origin-Bound Certificate Extension</h3>

<p>Origin-bound certificates MUST be X.509 v3 certificates,
	  and MUST include the origin-bound certificate extension (OID
	  1.3.6.1.4.111129.2.1.6), shown below.  This extension MUST
	  be marked critical.
</p>
<p>The data of the extension will be the <a class='info' href='#WebOrigin'>ASCII Serialization<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin] of the
          certificate's <a class='info' href='#WebOrigin'>web origin<span> (</span><span class='info'>Barth, A., &ldquo;The Web Origin Concept,&rdquo; .</span><span>)</span></a> [WebOrigin] as
          an IA5String.
</p><br /><hr class="insert" />
<a name="figure_extension"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 id-ce-originBoundCertificate OBJECT IDENTIFIER ::=
         { enterprises Google 2 1 6 }

 OriginBoundCertificate ::=
         IA5String
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Certificate and Key Rotation</h3>

<p>After a client has created an origin-bound certificate for
	a certain web origin, the client SHOULD re-use the certificate
	for a period of time, and then discard it.
</p>
<p>The client MUST discard existing origin-bound certificate
	at or before the notAfter time indicated in each
	certificate.
</p>
<p>The client MAY opt to discard an existing origin-bound
	certificate at any time of its choosing prior to the notAfter
	time indicated in the certificate. In particular, the client
	may delete an existing origin-bound certificate in response to
	a user request to clear privacy-sensitive state from their
	user-agent, ensuring that a fresh certificate will be
	generated the next time a user visits that origin.
</p>
<p>The client SHOULD use a new key pair when it generates a new
	  origin-bound certificate.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Changes to The Handshake Message Contents</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Extension Definition</h3>

<p>This document defines a new TLS extension, <tt>ob_cert</tt> (with tentative extension type
	0xff0f), which indicates that client and server agree to allow
	the client to use an origin-bound certificate to authenticate
	itself to the server.
</p>
<p>To indicate support for origin-bound certificates, the
	client includes an extension of type <tt>ob_cert</tt> in the Extended Client Hello
	message. To request client authentication with an origin-bound
	certificate, the server includes the same extension in
	Extended Server Hello message.
</p>
<p>The <tt>ob_cert</tt> TLS extension will
	be assigned a value from the TLS ExtensionType registry, and
	will contain zero
	length <tt>extension_data</tt>. For
	testing, we will use the extension type value of 0xff0f. For
	this type value, the entire encoding of the extension will be
	ff 0f 00 00 00.
       
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Client Hello</h3>

<p>A client wishing to indicate support for origin-bound
        client certificates MUST include the <tt>ob_cert</tt> in the extended Client Hello
        message to a server from a particular web origin.
	
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Server Hello</h3>

<p>A server that receives a Client Hello message containing
	the <tt>ob_cert</tt> extension MAY choose
	to include the same extension in the extended Server Hello
	message. If it does, the client and server are considered to
	have negotiated origin-bound client certificates for the
	session.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Certificate Request</h3>

<p>A server MAY choose to send a Certificate Request message
	to the client. If the session uses origin-bound client
	certificates, the server MAY use an empty <tt>certificate_authorities</tt> list.
</p>
<p>A client that receives a Certificate Request during a
	session for which origin-bound client certificates were
	negotiated MUST ignore the <tt>certificate_authorities</tt> list.
</p>
<a name="ClientCertificateMessage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Client Certificate</h3>

<p><a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] requires that a client
	that receives a Certificate Request message must send a Client
	Certificate message in response (which may or may not include
	client certificates). If client and server negotiated
	origin-bound client certificates, then the client SHOULD
	include a certificate in the Client Certificate message. If
	the <tt>certificate_authorities</tt> list
	in the Certificate Request is empty, that certificate SHOULD
	be an origin-bound certificate, and it should be selected by
	the client without any assistance or approval by the
	end-user. If the <tt>certificate_authorities</tt> list in the
	Certificate Request is not empty, the client MAY select a
	regular certificate for inclusion in the Client Certificate
	message, and MAY involve the end-user in the certificate
	selection process.
</p>
<p>If a client includes an origin-bound certificate in the
	Client Certificate message during a session for which
	origin-bound client certificates were negotiated, the included
	certificate MUST
        </p>
<ul class="text">
<li>be an origin-bound certificate for the web origin of
	    the server, and 
</li>
<li>match a certificate type requested by the server in the
	    Certificate Request message.
</li>
</ul>

<p>If a client doesn't possess a certificate meeting the above
	requirements, it SHOULD self-issue a certificate of a type
	requested by the server in the Certificate Request message and
	include the newly-generated certificate in the Client
	Certificate message. Only if the client is not capable of
	providing a certificate of the requested type SHOULD it
	include an empty <tt>certificate_list</tt>
	in the Client Certificate message.
</p>
<p>A server verifying a Client Certificate message in a
	  handshake that negotiated origin-bound client certificates
	  MUST verify that the certificate is self-signed, rather than
	  being signed by any particular CA. The server MUST verify
	  that the public key in the certificate corresponds to the
	  key used to authenticate the client in the handshake. The
	  server SHOULD ignore the Issuer and Subject in the presented
	  certificate. The server MUST ignore the notBefore and
	  notAfter fields in the certificate.
</p>
<p>Finally, the server MUST verify that the certificate contains
	  the origin-bound extension, and SHOULD verify that the origin
	  identified in that certificate matches the server. In
	  particular, the scheme MUST be https. The port MUST be the
	  server port to which the client connected for the TLS
	  connection, and the host name MUST be a valid host name for
	  the server. If the client uses SNI, then the hostname in the
	  origin-bound certificate must match the hostname specified
	  in the SNI extension.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Third-Party Tracking</h3>

<p>A third party might be able to track a client across
	multiple sessions by observing the use of the same
	origin-bound certificate. To alleviate this concern, clients
	SHOULD also implement the <a class='info' href='#CertMessageReordering'>CertificateMessage Reordering
	Extension<span> (</span><span class='info'>, &ldquo;TODO: Reference for ClientCertificate message 	  reordering,&rdquo; .</span><span>)</span></a> [CertMessageReordering], and use it concurrently with TLS-OBC. The
	<a class='info' href='#CertMessageReordering'>CertificateMessage
	Reordering Extension<span> (</span><span class='info'>, &ldquo;TODO: Reference for ClientCertificate message 	  reordering,&rdquo; .</span><span>)</span></a> [CertMessageReordering]ensures that the origin-bound
	certificate is sent after TLS established secrecy on the
	channel between client and server.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Server Tracking</h3>

<p>A client can prevent server tacking by deleting the
	origin-bound certificate for the server's Web origin. This
	could happen, for example, when the user elects to remove all
	cookies for that origin.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Cookie Hardening</h3>

<p>One way TLS-OBC can be used to strengthen cookie-based
	authentication is by "binding" cookies to an origin-bound
	certificate. The server, when issuing a cookie for an HTTP
	session, would associate the client's origin-bound certificate
	with the session (either by encoding information about the
	certificate unforgeably in the cookie), or by associating the
	certificate with the cookie's session through some other
	means. That way, if and when a cookie gets stolen from a
	client, it cannot be used over a different TLS connection -
	the cookie thief would also have to steal the private key
	associated with the client's origin-bound certificate, a task
	considerably harder especially when we assume the existence of
	a Trusted Platform Module or other Secure Element that can
	store the origin-bound-certificate's private key.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CertMessageReordering">[CertMessageReordering]</a></td>
<td class="author-text">&ldquo;<a href="http://example.com">TODO: Reference for ClientCertificate message
	  reordering</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6066">[RFC6066]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>,&rdquo; RFC&nbsp;6066, January&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6066.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="WebOrigin">[WebOrigin]</a></td>
<td class="author-text">Barth, A., &ldquo;<a href="http://tools.ietf.org/html/draft-abarth-origin-09">The Web Origin Concept</a>.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dirk Balfanz (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1600 Ampitheatre Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:balfanz@google.com">balfanz@google.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">D K Smetters</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mayank Upadhyay</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adam Barth</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
</table>
</body></html>
